<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
    <link rel="stylesheet" type="text/css" href="./lib/bouncy.css" />
    <script src="./lib/underscore.js"></script>
    <script src="./lib/d3.v3.js"></script>
    <script src="lib/jquery.js"></script>

</head>
<body>
    <div class="titleDiv">
        <h1 class="title">bouncy balls</h1>
    </div>
    <div class="score"><p id="yourScoreText">your score </p></score>
    <div class="goodCircle"></div>
    
    <div class="gameBox"></div> <!-- main game div -->

  
        <script>
        var title = d3.select("h1");
        var body = d3.select("body");
        var r = 15;
        var gameStats = {
                      score: 0,
                      bestScore: 0
                    };

        var w = window.innerWidth, h = window.innerHeight;
        
        var container = body.append("svg")
            .attr("width", w)
            .attr("height", h)
            .style("fill", "white");
       
        var circleMovement = {
                    "r" : r,
                    "cx": function(){ return Math.random() * w; },
                    "cy": function(){ return Math.random() * h; }
                    };

        var circleData = d3.range(0,40);

        var allEnemies = container.selectAll("circle")
                .data(circleData)
                .enter()
                .append("circle")
                .attr("class", "enemy")
                .style("fill", function(i){ return "#"+((1<<24)*Math.random()|0).toString(16)})
    
        container.selectAll(".enemy").attr(circleMovement);
               
        var enemyOnTheMove = function(){
            container.selectAll(".enemy")
            .transition().duration(2000)
            .attr(circleMovement)
        };

        // d3.timer(enemyOnTheMove, 2000);
        setInterval(enemyOnTheMove, 2000); // dance, dancy balls, dance!                
        
        var playerData = [500]; // gotta concat the data, otherwise you overwrite
       
        var player = container.selectAll("circle") // your player
            .data(circleData.concat(playerData))
            .enter()
            .append("circle")
            .attr({"r" : r * 1.8,
                "class" : "player",
                cx : w / 2, cy : h / 2
            })
            
            .style({ fill : "white",
                    stroke : "black"});

        var score = d3.select(".score");

        var drag = d3.behavior.drag().on("drag", dragmove);

        var dragmove = function() {
            var x = d3.event.x;
            var y = d3.event.y;
            player.attr({ cx: x, cy: y });
        }

        player.call(drag);

        </script>
</body>
</html>